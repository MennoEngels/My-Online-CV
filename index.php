<html>
<head>
    <meta charset="UTF-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="Software Engineer">
    <meta name="keywords" content="Python, Software Engineer, Netherlands, Web">
    <meta name="theme-color" content="#edf2f4">

    <title>Resume | Menno Engels</title>

    <link rel="shortcut icon" href="img/favicon.ico" hreflang="en-nl">
    <link rel="shortcut icon" type="image/x-icon" href="img/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="img/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="img/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="img/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#ef233c">

    <meta property="og:title" content="Resume | Menno Engels" />
    <meta property="og:description" content="" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="http://www.mennoengels.com/resume" />
    <meta property="og:site_name" content="Resume | Menno Engels" />
    <meta property="og:image" content="http://mennoengels.com/img/og.png" />
    <meta property="og:image:width" content="1280" />
    <meta property="og:image:height" content="672" />
    <meta property="og:image:type" content="image/png" />
    <meta property="og:locale" content="en_NL">

    <meta itemprop="name" content="Resume | Menno Engels">
    <meta itemprop="description" content="Software Engineer">
    <meta itemprop="image" content="http://mennoengels.com/img/og.png">

    <link href="https://fonts.googleapis.com/css?family=Catamaran:200,300,400,500,600,700" rel="stylesheet">
    <link rel="stylesheet" href="main.css">
</head>
<body>
    <div class="menu">
        <div class="lang_switch"><a href="#" onclick="changeLanguage('nl')">NL</a><span> / </span><a href="#" onclick="changeLanguage('en')">EN</a></div>
        <div class="resume-wrapper">
            <a class="resume-btn" href="/resume.pdf" target="_blank" rel="noopener noreferrer">Download Resume</a>
        </div>
    </div>
    <div class="center">
        <div class="center-inner">
            <div class="introduction">
                <h1 id="intro_title" class="intro_title">Menno Engels</h1>
                <h2 id="intro_sub" class="intro_sub">Software Engineer</h2>
                <div class="content">
                    <p id="intro_1" class="intro-p">Hi, I'm Menno Engels, a Software Engineer who is passionate about creating
                        practical solutions to real world problems. My expertise includes developing complex systems and
                        software applications using a range of programming languages and technologies. I have experience
                        working with both front-end and back-end technologies and have a deep understanding of software
                        development best practices, including agile methodologies, code review, and testing.
                        In addition, I am dedicated to staying up to date with the latest technological advancements and
                        continuously seek to improve my skills and knowledge.
                    </p>
                    <p id="intro_2" class="intro-p">I am currently focusing on building interesting and practical projects to further
                        develop my Python skills.</p>
                </div>
            </div>
            <div class="experience">
                <h4 id="experience_title">Experience</h4>
                <div class="content">
                    <div class="exp-item">
                        <div class="job">
                            <a id="experience_1_company" class="company" href="" target="_blank">In-terest</a>
                            <div id="experience_1_duration" class="duration">Februari 2021 &mdash; June 2022</div>
                        </div>
                        <div id="experience_1_title" class="title">IOS Developer</div>
                        <ul class="description">
                            <li id="experience_1_description_1">As part of the development team for an indoor positioning system, I played a key role in
                                rewriting code for an IOS App to improve its performance</li>
                            <li id="experience_1_description_2">Developed code for an outdated content management system and integrating it with the
                                mobile app.</li>
                            <li id="experience_1_description_3">Guiding new interns in learning Swift and continuing the development of an IOS
                                application</li>
                        </ul>
                    </div>
                    <div class="exp-item">
                        <div class="job">
                            <a id="experience_2_company" class="company" href="https://www.hcas.nl" target="_blank">HCAS Hockey Club.</a>
                            <div id="experience_2_duration" class="duration">September 2019 &mdash; Februari 2020</div>
                        </div>
                        <div id="experience_2_title" class="title">Full-Stack Developer</div>
                        <ul class="description">
                            <li id="experience_2_description_1">Developed an online platform to manage hockey players and enhance their performance.</li>
                            <li id="experience_2_description_2">Build a training environment that enables coaches to design and
                                implement personalized training programs.</li>
                            <li id="experience_2_description_3">In collaboration with SmartGoals B.V., hockey players were enabled to rewatch their
                                matches and training sessions online.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="right">
            <div class="data content">
                <div>Menno Engels</div>
                <div>Menno.engels@live.nl</div>
                <div>MennoEngels.com</div>
                <div>+31652379121</div>
            </div>
            <div class="education">
                <h4 id="education_title">Education</h4>
                <div class="content">
                    <div class="school"><a id="education_school" href="https://www.summacollege.nl" target="_blank">Summa College</a>
                    </div>
                    <div class="college"><a id="education_college" href="https://www.summacollege.nl/opleidingen/software-developer-bol"
                            target="_blank">ICT</a></div>
                    <div class="major"><strong id="major_title">Major:</strong><span id="major"> Software Development</span></div>
                    <div class="minor"><strong id="minor_title">Minor:</strong><span id="minor"> Mobile Application Development</span></div>
                    <div id="education_graduation" class="grad-date">Graduated in Juli 2021</div>
                </div>
            </div>
            <div class="skills">
                <h4 id="skill_title">Skills</h4>
                <div class="content">
                    <div class="skill-category">
                        <strong id="skill_title_1">Languages: &nbsp;</strong>
                        <span id="skill_1">Python, HTML, CSS, JavaScript, PHP, Swift, C#</span>
                    </div>
                    <div class="skill-category">
                        <strong id="skill_title_2">Libraries &amp; Frameworks: &nbsp;</strong>
                        <span id="skill_2">Flask, Pandas, Matplotlib, </span>
                    </div>
                    <div class="skill-category">
                        <strong id="skill_title_3">Tools: &nbsp;</strong>
                        <span id="skill_3">Git, VSCode, Xcode, MySQLWorkbench, Excel, Jupyter</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
<script>
    var language;

    function changeLanguage(lang) {
        localStorage.setItem('language', lang);
        getLanguage(lang);
    }

    function getLanguage(language_set) {
            var request = new XMLHttpRequest();
            request.open('GET', '/My-Online-CV/language/' + language_set + '.json', false);
            request.setRequestHeader('Content-type', 'application/json; charset=utf-8');
            request.send();
            if (request.readyState === 4 && request.status === 200) {
                var lang = JSON.parse(request.responseText);
                language = lang;
            }

            setLanguage(language_set);
    }

    function setLanguage(language_set) {
        for (const [key, value] of Object.entries(language)) {
            document.getElementById(key).textContent = value;
        }
    }

    document.addEventListener('DOMContentLoaded', function () {
        if (localStorage.getItem('language') === null) {
            getLanguage('en');
        } else {
            getLanguage(localStorage.getItem('language'));
        }
    });
</script>
</html>
<?php
use \CloudConvert\CloudConvert;
use \CloudConvert\Models\Job;
use \CloudConvert\Models\Task;

require_once('vendor/autoload.php');
include_once('simple_html_dom.php');

function convertHtmlToPdf($language) {
    include('config.php');
    $cloudconvert = new CloudConvert(['api_key' => $api_key]);

    $job = (new Job())
    ->addTask(
        (new Task('import/upload', 'import-1'))
        )
    ->addTask(
        (new Task('convert', 'task-1'))
            ->set('input_format', 'html')
            ->set('output_format', 'pdf')
            ->set('engine', 'chrome')
            ->set('input', ["import-1"])
            ->set('pages', '1')
            ->set('zoom', 1)
            ->set('margin_top', 12)
            ->set('margin_bottom', 12)
            ->set('margin_left', 12)
            ->set('margin_right', 12)
            ->set('print_background', true)
            ->set('display_header_footer', false)
            ->set('wait_until', 'load')
            ->set('wait_time', 0)
            ->set('css_media_type', 'screen')
            ->set('filename', 'pdf_' . $language . '.pdf')
            ->set('engine_version', '110')
        )
    ->addTask(
        (new Task('export/url', 'export-1'))
            ->set('input', ["task-1"])
            ->set('inline', false)
            ->set('archive_multiple_files', false)
        ); 

    $cloudconvert->jobs()->create($job);

    $uploadTask = $job->getTasks()->whereName('import-1')[0];

    $cloudconvert->tasks()->upload($uploadTask, fopen('./temp/temp_' . $language . '.html', 'r'), 'temp.html');

    $cloudconvert->jobs()->wait($job);

    foreach ($job->getExportUrls() as $file) {

        $source = $cloudconvert->getHttpTransport()->download($file->url)->detach();
        $dest = fopen($file->filename, 'w');
        
        stream_copy_to_stream($source, $dest);
    }
}

// Load HTML code from a file and extract content up to closing </html> tag
function extractHtmlContent($filename) {
    $html = file_get_contents($filename);
    $lines = explode("\n", $html);
    $htmlEndLine = null;
    foreach ($lines as $lineNumber => $line) {
        if (strpos($line, '</html>') !== false) {
            $htmlEndLine = $lineNumber;
            break;
        }
    }
    if ($htmlEndLine !== null) {
        $lines = array_slice($lines, 0, $htmlEndLine + 1);
        $html = implode("\n", $lines);
    }
    return $html;
}

// Update HTML elements with CSS styles
function updateHtmlStyles($html) {

    $htmlDom = str_get_html($html);

    $elements = $htmlDom->find('.center');
    foreach($elements as $element) {
        $element->style = 'width: 100%; padding: 0px;';
    }

    foreach ($htmlDom->find('.menu') as $element) {
        $element->outertext = '';
    }

    $body = $htmlDom->find('body', 0);
    $body->style = 'background-color: white;';

    return $htmlDom->save();
}

// Convert CSS styles to inline styles
function convertCssToInlineStyles($html, $css) {
    $converter = new \TijsVerkoyen\CssToInlineStyles\CssToInlineStyles();

    $htmlDom = str_get_html($html);

    $options = [
        'strip_original_style_tags' => true,
    ];

    $convertedHtml = $converter->convert($htmlDom, $css, $options);

    return $convertedHtml;
}

function setLanguage($html, $language) {

    $jsonString = file_get_contents('language/' . $language . '.json');
    $htmlDom = str_get_html($html);

    $decodedArray = json_decode($jsonString, true);

    foreach ($decodedArray as $key => $value) {

        $element = $htmlDom->find('#' . $key, 0);

        if ($element) {
            $element->innertext = $value;
        }
    }
    
    return $htmlDom->save();
}

function processFile($language) {
    $html = extractHtmlContent('index.php');
    $html = setLanguage($html, $language);
    $html = updateHtmlStyles($html);
    $css = file_get_contents('main.css');
    $convertedHtml = convertCssToInlineStyles($html, $css);
    $file = 'temp/temp_' . $language . '.html';
    file_put_contents($file, $convertedHtml);
    convertHtmlToPdf($language);
}

function updatePdfs() {
    $pid = pcntl_fork(); // create a child process

    if ($pid == -1) {
        die('Error: could not fork process');
    } else if ($pid) {
        // parent process
        return;
    } else {
        // child process
        $folder_path = 'language';
        $files = scandir($folder_path);
        
        foreach ($files as $file) {
            $file_parts = explode('.', $file);
            $file_extension = end($file_parts);
            if ($file_extension === 'json') {
                $language = reset($file_parts);
                processFile($language);
            }
        }

        exit(); 
    }
}

function checkForUpdates() {
    $jsonString = file_get_contents('lastmod.json');
    $file_info = json_decode($jsonString, true);

    $files = array();

    foreach ($file_info as $key => $file) {
        // Get the file name and date/time
        $file_path = $file["file_path"];
        $file_date = $file["last_modified_date"];
        $last_modified_date = date("Y-m-d H:i:s", filemtime($file_path));

        // Check if the file exists
        if (file_exists($file_path)) {
            if ($last_modified_date > $file_date) {
                $file_info[$key]["last_modified_date"] = $last_modified_date;
                // Get an array of all files in the folder
                updatePdfs();
                break;
            } 
        } else {
            // Remove the entry from the array if the file doesn't exist
            unset($file_info[$key]);
        }
    }

    $json = json_encode($file_info, JSON_PRETTY_PRINT);
    file_put_contents('lastmod.json', $json);
}

checkForUpdates();
?>